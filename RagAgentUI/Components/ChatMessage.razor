@using RagAgentUI.Models

<div class="@(IsUser ? "flex justify-end" : "flex justify-start") mb-4 animate-fade-in">
    <div class="@(IsUser ? "bg-blue-500 text-white" : "bg-gray-100 text-gray-900 dark:bg-gray-800 dark:text-white") 
 max-w-[75%] rounded-2xl px-4 py-3 shadow-sm">
        
        <div class="flex items-center gap-2 mb-1">
<span class="text-xs font-semibold opacity-90">
     @(IsUser ? "You" : "ðŸ¤– Assistant")
            </span>
      <span class="text-xs opacity-60">
 @CreatedAt.ToString("HH:mm")
         </span>
        </div>
  
     <div class="prose prose-sm max-w-none @(IsUser ? "prose-invert" : "")">
      @((MarkupString)Content)
        </div>
  
        @if (Sources?.Any() == true)
        {
     <div class="mt-3 pt-3 border-t @(IsUser ? "border-white/20" : "border-gray-300")">
 <p class="text-xs font-medium mb-2">ðŸ“š Sources:</p>
     @foreach (var source in Sources)
              {
           <a href="@source.Url" 
               class="text-xs underline hover:no-underline opacity-80 hover:opacity-100 block mb-1 transition-opacity"
     target="_blank">
            @source.Url
                <span class="ml-2 text-[10px] opacity-60">
        (@(Math.Round(source.RelevanceScore * 100))% match)
      </span>
        </a>
        }
      </div>
      }
    </div>
</div>

@code {
[Parameter] public bool IsUser { get; set; }
    [Parameter] public string Content { get; set; } = string.Empty;
    [Parameter] public DateTime CreatedAt { get; set; }
    [Parameter] public List<SourceDto>? Sources { get; set; }
}